{"version":3,"file":"1-timer.js","sources":["../src/js/1-timer.js"],"sourcesContent":["import flatpickr from 'flatpickr';\nimport 'flatpickr/dist/flatpickr.css';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst refs = {\n  startBtnEl: document.querySelector('button[data-start]'),\n  datetimePickerEl: document.querySelector('#datetime-picker'),\n  clockfacEl: document.querySelector('.timer'),\n\n  timer: {\n    daysEl: document.querySelector('span[data-days]'),\n    hoursEl: document.querySelector('span[data-hours]'),\n    minutesEl: document.querySelector('span[data-minutes]'),\n    secondsEl: document.querySelector('span[data-seconds]'),\n  },\n};\n\nlet userSelectedDate = null;\n\nconst customLocale = {\n  weekdays: {\n    shorthand: ['Su', 'Mo', 'Tu', 'We', 'Th', 'Fr', 'Sa'],\n    longhand: [\n      'Sunday',\n      'Monday',\n      'Tuesday',\n      'Wednesday',\n      'Thursday',\n      'Friday',\n      'Saturday',\n    ],\n  },\n  months: {\n    shorthand: [\n      'Jan',\n      'Feb',\n      'Mar',\n      'Apr',\n      'May',\n      'Jun',\n      'Jul',\n      'Aug',\n      'Sep',\n      'Oct',\n      'Nov',\n      'Dec',\n    ],\n    longhand: [\n      'January',\n      'February',\n      'March',\n      'April',\n      'May',\n      'June',\n      'July',\n      'August',\n      'September',\n      'October',\n      'November',\n      'December',\n    ],\n  },\n  firstDayOfWeek: 1,\n};\n\nconst options = {\n  enableTime: true,\n  time_24hr: true,\n  defaultDate: new Date(),\n  minuteIncrement: 1,\n  locale: customLocale,\n  disableMobile: true,\n  onClose(selectedDates) {\n    const currentDate = Date.now();\n    userSelectedDate = selectedDates[0];\n\n    if (userSelectedDate) {\n      const isValidDate = isFutureDate({\n        currentDate,\n        userSelectedDate,\n      });\n      handleDateInputChange(isValidDate);\n    }\n  },\n};\n\nconst fp = flatpickr('#datetime-picker', options);\n\n//!======================================================\nconst timer = {\n  intervalId: null,\n\n  start() {\n    if (this.intervalId) return;\n    if (!userSelectedDate) return;\n\n    toggleDisabled({ elem: refs.startBtnEl, disabled: true });\n    toggleDisabled({ elem: refs.datetimePickerEl, disabled: true });\n\n    this.intervalId = setInterval(() => {\n      this.tick();\n    }, 1000);\n  },\n\n  stop() {\n    clearInterval(this.intervalId);\n    toggleDisabled({ elem: refs.startBtnEl, disabled: false });\n    toggleDisabled({ elem: refs.datetimePickerEl, disabled: false });\n\n    userSelectedDate = null;\n    this.intervalId = null;\n    updateTimerMarkup(\n      refs.timer,\n      formatTimeData({ days: 0, hours: 0, minutes: 0, seconds: 0 })\n    );\n  },\n\n  tick() {\n    const currentTime = Date.now();\n    const diffMs = userSelectedDate - currentTime;\n\n    if (diffMs <= 0) {\n      timer.stop();\n      return;\n    }\n\n    const timeObj = convertMs(diffMs);\n    updateTimerMarkup(refs.timer, formatTimeData(timeObj));\n  },\n};\n\nrefs.startBtnEl.addEventListener('click', () => {\n  timer.start();\n});\n\n//!======================================================\nfunction isFutureDate({ currentDate, userSelectedDate }) {\n  const diff = userSelectedDate - currentDate;\n  return diff > 1000;\n}\n\nfunction convertMs(ms) {\n  // Number of milliseconds per unit of time\n  const second = 1000;\n  const minute = second * 60;\n  const hour = minute * 60;\n  const day = hour * 24;\n  // Remaining days\n  const days = Math.floor(ms / day);\n  // Remaining hours\n  const hours = Math.floor((ms % day) / hour);\n  // Remaining minutes\n  const minutes = Math.floor(((ms % day) % hour) / minute);\n  // Remaining seconds\n  const seconds = Math.floor((((ms % day) % hour) % minute) / second);\n  return { days, hours, minutes, seconds };\n}\n\nfunction addLeadingZero(value) {\n  return String(value).padStart(2, '0');\n}\n\nfunction formatTimeData(timerData) {\n  const dateKeys = Object.keys(timerData);\n  let formattedData = {};\n\n  for (const key of dateKeys) {\n    formattedData[key] = addLeadingZero(timerData[key]);\n  }\n  return formattedData;\n}\n\n//!======================================================\nfunction toggleDisabled({ disabled = true, elem = {} }) {\n  elem.disabled = disabled;\n}\n\nfunction handleDateInputChange(isValidDate) {\n  if (!isValidDate) {\n    toggleDisabled({ elem: refs.startBtnEl, disabled: true });\n    showMessage();\n    return;\n  }\n  toggleDisabled({ elem: refs.startBtnEl, disabled: false });\n}\n\nfunction showMessage() {\n  iziToast.show({\n    title: 'Error',\n    message: 'Please choose a date in the future',\n    titleColor: '#fff',\n    icon: '../img/error-icon.svg',\n    position: 'topRight',\n    class: 'custom-error-toast',\n    timeout: 3000,\n  });\n}\n\nfunction updateTimerMarkup(timerObjElems, timerValues) {\n  const timerElems = Object.keys(timerObjElems);\n\n  for (const elemKey of timerElems) {\n    const key = elemKey.slice(0, -2);\n    const timerElem = timerObjElems[elemKey];\n    timerElem.textContent = timerValues[key];\n  }\n}\n"],"names":["refs","userSelectedDate","customLocale","options","selectedDates","currentDate","isValidDate","isFutureDate","handleDateInputChange","flatpickr","timer","toggleDisabled","updateTimerMarkup","formatTimeData","currentTime","diffMs","timeObj","convertMs","ms","days","hours","minutes","seconds","addLeadingZero","value","timerData","dateKeys","formattedData","key","disabled","elem","showMessage","iziToast","timerObjElems","timerValues","timerElems","elemKey","timerElem"],"mappings":"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"}